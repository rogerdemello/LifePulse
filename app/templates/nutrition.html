{% extends "base.html" %}

{% block title %}Nutrition Information Explorer - LifePulse{% endblock %}
{% block description %}Discover comprehensive nutritional information, health benefits, and dietary insights for any food with our nutrition explorer.{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="text-center mb-4">
    <h2 class="fw-bold mb-2">ü•ó Nutrition Information Explorer</h2>
    <p class="text-muted">Discover nutritional facts, health benefits, and dietary insights</p>
  </div>

  <div class="row justify-content-center">
    <div class="col-md-10">
      
      <!-- Search Form -->
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body p-4">
          <form method="POST" action="{{ url_for('nutrition.nutrition_lookup') }}">
            <div class="input-group input-group-lg">
              <span class="input-group-text bg-white border-end-0">
                <span style="font-size: 1.5rem;">üîç</span>
              </span>
              <input type="text" name="food" class="form-control border-start-0 ps-0" 
                     placeholder="Search any food... (e.g., banana, chicken breast, spinach)" 
                     value="{{ food_name if food_name else '' }}"
                     style="font-size: 1.1rem;"
                     required>
              <button type="submit" class="btn btn-success px-5" style="font-size: 1.1rem;">
                Search
              </button>
            </div>
            <div class="mt-3 text-center">
              <small class="text-muted fw-semibold">üí° Popular Searches:</small><br>
              <div class="mt-2">
                <span class="badge bg-light text-dark border me-1 mb-1">üçå Banana</span>
                <span class="badge bg-light text-dark border me-1 mb-1">ü•¨ Spinach</span>
                <span class="badge bg-light text-dark border me-1 mb-1">üçó Chicken</span>
                <span class="badge bg-light text-dark border me-1 mb-1">ü•¶ Broccoli</span>
                <span class="badge bg-light text-dark border me-1 mb-1">üêü Salmon</span>
                <span class="badge bg-light text-dark border me-1 mb-1">ü•ë Avocado</span>
                <span class="badge bg-light text-dark border me-1 mb-1">ü•ö Egg</span>
                <span class="badge bg-light text-dark border me-1 mb-1">üçö Rice</span>
              </div>
            </div>
          </form>
        </div>
      </div>

      {% if nutrition_info %}
        {% if nutrition_info.error %}
          <!-- Error Message -->
          <div class="card border-0 shadow-sm border-start border-warning border-4">
            <div class="card-body p-4">
              <div class="d-flex align-items-start">
                <div class="me-3" style="font-size: 3rem;">‚ö†Ô∏è</div>
                <div>
                  <h5 class="text-warning mb-2">{{ nutrition_info.error }}</h5>
                  <p class="text-muted mb-3">
                    We couldn't find nutritional information for "<strong>{{ food_name }}</strong>". 
                    This could be due to spelling, or the food might not be in our database yet.
                  </p>
                  <div class="alert alert-light mb-0">
                    <strong>üí° Tips:</strong>
                    <ul class="mb-0 mt-2">
                      <li>Check your spelling</li>
                      <li>Try a simpler term (e.g., "chicken" instead of "grilled chicken breast")</li>
                      <li>Use common food names</li>
                      <li>Try our popular searches above</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        {% else %}
          <!-- Results Header -->
          <div class="card border-0 shadow mb-4" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
            <div class="card-body text-white text-center py-4">
              <div style="font-size: 4rem; margin-bottom: 0.5rem;">
                {% if 'banana' in food_name.lower() %}üçå
                {% elif 'spinach' in food_name.lower() %}ü•¨
                {% elif 'chicken' in food_name.lower() %}üçó
                {% elif 'broccoli' in food_name.lower() %}ü•¶
                {% elif 'salmon' in food_name.lower() %}üêü
                {% elif 'avocado' in food_name.lower() %}ü•ë
                {% elif 'egg' in food_name.lower() %}ü•ö
                {% elif 'rice' in food_name.lower() %}üçö
                {% elif 'milk' in food_name.lower() %}ü•õ
                {% elif 'apple' in food_name.lower() %}üçé
                {% elif 'yogurt' in food_name.lower() %}ü•õ
                {% elif 'oats' in food_name.lower() %}üåæ
                {% elif 'tomato' in food_name.lower() %}üçÖ
                {% else %}ü•ó{% endif %}
              </div>
              <h2 class="mb-2 fw-bold">{{ food_name|title }}</h2>
              <p class="mb-0 opacity-90">Nutritional information per 100g serving</p>
            </div>
          </div>

          <!-- Main Nutrients -->
          {% if nutrition_info.nutrients %}
          <div class="card border-0 shadow-sm mb-4">
            <div class="card-header text-white py-3" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
              <h5 class="mb-0">ÔøΩ Nutritional Values</h5>
            </div>
            <div class="card-body p-4">
              <div class="row g-3">
                {% for key, value in nutrition_info.nutrients.items() %}
                  {% if loop.index <= 8 %}
                  <div class="col-md-3 col-6">
                    <div class="card border-0 h-100" style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);">
                      <div class="card-body text-center p-3">
                        <h6 class="text-muted small mb-2">{{ key }}</h6>
                        <h5 class="fw-bold mb-0 text-primary">{{ value }}</h5>
                      </div>
                    </div>
                  </div>
                  {% endif %}
                {% endfor %}
              </div>
              
              {% if nutrition_info.nutrients|length > 8 %}
              <div class="mt-4 text-center">
                <button class="btn btn-outline-primary" type="button" data-bs-toggle="collapse" data-bs-target="#allNutrients">
                  <span class="me-2">üìã</span> Show All {{ nutrition_info.nutrients|length }} Nutrients
                </button>
                <div class="collapse mt-3" id="allNutrients">
                  <div class="row g-3">
                    {% for key, value in nutrition_info.nutrients.items() %}
                      {% if loop.index > 8 %}
                      <div class="col-md-3 col-6">
                        <div class="card border-0 h-100" style="background: #f8f9fa;">
                          <div class="card-body text-center p-2">
                            <small class="text-muted d-block mb-1">{{ key }}</small>
                            <strong class="text-primary">{{ value }}</strong>
                          </div>
                        </div>
                      </div>
                      {% endif %}
                    {% endfor %}
                  </div>
                </div>
              </div>
              {% endif %}
            </div>
          </div>
          {% endif %}

          <!-- Vitamins & Minerals -->
          {% if nutrition_info.vitamins or nutrition_info.minerals %}
          <div class="row g-3 mb-4">
            {% if nutrition_info.vitamins %}
            <div class="col-md-6">
              <div class="card border-0 shadow-sm h-100">
                <div class="card-header text-white py-3" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                  <h6 class="mb-0">üíä Vitamins</h6>
                </div>
                <div class="card-body p-4">
                  <div class="d-flex flex-wrap gap-2">
                    {% for vitamin in nutrition_info.vitamins %}
                      <span class="badge fs-6 px-3 py-2" style="background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%); color: #333;">
                        {{ vitamin }}
                      </span>
                    {% endfor %}
                  </div>
                </div>
              </div>
            </div>
            {% endif %}
            
            {% if nutrition_info.minerals %}
            <div class="col-md-6">
              <div class="card border-0 shadow-sm h-100">
                <div class="card-header text-white py-3" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                  <h6 class="mb-0">‚ö° Minerals</h6>
                </div>
                <div class="card-body p-4">
                  <div class="d-flex flex-wrap gap-2">
                    {% for mineral in nutrition_info.minerals %}
                      <span class="badge fs-6 px-3 py-2" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); color: #333;">
                        {{ mineral }}
                      </span>
                    {% endfor %}
                  </div>
                </div>
              </div>
            </div>
            {% endif %}
          </div>
          {% endif %}

          <!-- Benefits & Risks -->
          <div class="row g-3 mb-4">
            <!-- Benefits -->
            {% if nutrition_info.benefits %}
            <div class="col-md-6">
              <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-success text-white py-3">
                  <h5 class="mb-0">‚úÖ Health Benefits</h5>
                </div>
                <div class="card-body p-4">
                  <ul class="mb-0">
                    {% for benefit in nutrition_info.benefits %}
                      <li class="mb-3">
                        <span class="fw-semibold">{{ benefit }}</span>
                      </li>
                    {% endfor %}
                  </ul>
                </div>
              </div>
            </div>
            {% endif %}

            <!-- Considerations -->
            {% if nutrition_info.risks %}
            <div class="col-md-6">
              <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-warning text-dark py-3">
                  <h5 class="mb-0">‚ö†Ô∏è Considerations</h5>
                </div>
                <div class="card-body p-4">
                  <ul class="mb-0">
                    {% for risk in nutrition_info.risks %}
                      <li class="mb-3">
                        <span class="fw-semibold">{{ risk }}</span>
                      </li>
                    {% endfor %}
                  </ul>
                </div>
              </div>
            </div>
            {% endif %}
          </div>

          <!-- Quick Facts Card -->
          <div class="card border-0 shadow-sm mb-4" style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);">
            <div class="card-body p-4">
              <h6 class="fw-bold mb-3">üìå Quick Facts About {{ food_name|title }}</h6>
              <div class="row">
                <div class="col-md-4 mb-2">
                  <div class="d-flex align-items-center">
                    <span class="me-2">üì¶</span>
                    <small><strong>Serving Size:</strong> 100g</small>
                  </div>
                </div>
                <div class="col-md-4 mb-2">
                  <div class="d-flex align-items-center">
                    <span class="me-2">üçΩÔ∏è</span>
                    <small><strong>Category:</strong> Whole Food</small>
                  </div>
                </div>
                <div class="col-md-4 mb-2">
                  <div class="d-flex align-items-center">
                    <span class="me-2">üí™</span>
                    <small><strong>Nutrient Dense:</strong> Yes</small>
                  </div>
                </div>
              </div>
              <hr class="my-3">
              <small class="text-muted">
                <strong>‚ìò Note:</strong> Nutritional values are approximate and may vary based on variety, 
                ripeness, cooking method, and source. Always consult nutrition labels on packaged foods.
              </small>
            </div>
          </div>

          <!-- Navigation -->
          <div class="text-center">
            <a href="{{ url_for('nutrition.nutrition_lookup') }}" class="btn btn-success btn-lg px-4 me-2">
              üîç Search Another Food
            </a>
            <a href="/" class="btn btn-outline-secondary btn-lg px-4">
              üè† Back to Home
            </a>
          </div>
        {% endif %}
      {% else %}
        <!-- Initial State - No Search Yet -->
        <div class="row g-4 mt-2">
          <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100 hover-lift" style="cursor: pointer;">
              <div class="card-body text-center p-4">
                <div style="font-size: 3rem;" class="mb-3">ü•ó</div>
                <h5 class="fw-bold mb-2">Fruits & Vegetables</h5>
                <p class="text-muted small mb-0">
                  Rich in vitamins, minerals, fiber, and antioxidants for optimal health
                </p>
              </div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100 hover-lift" style="cursor: pointer;">
              <div class="card-body text-center p-4">
                <div style="font-size: 3rem;" class="mb-3">üçó</div>
                <h5 class="fw-bold mb-2">Proteins</h5>
                <p class="text-muted small mb-0">
                  Essential for muscle growth, repair, and overall body function
                </p>
              </div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100 hover-lift" style="cursor: pointer;">
              <div class="card-body text-center p-4">
                <div style="font-size: 3rem;" class="mb-3">üåæ</div>
                <h5 class="fw-bold mb-2">Whole Grains</h5>
                <p class="text-muted small mb-0">
                  Provide sustained energy, fiber, and important B vitamins
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Info Section -->
        <div class="card border-0 shadow-sm mt-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
          <div class="card-body text-white p-4">
            <h5 class="fw-bold mb-3">üåü Why Track Nutrition?</h5>
            <div class="row">
              <div class="col-md-6">
                <ul class="mb-0">
                  <li class="mb-2">Make informed dietary choices</li>
                  <li class="mb-2">Understand macronutrient balance</li>
                  <li class="mb-2">Identify nutrient-rich foods</li>
                </ul>
              </div>
              <div class="col-md-6">
                <ul class="mb-0">
                  <li class="mb-2">Support health and fitness goals</li>
                  <li class="mb-2">Manage dietary restrictions</li>
                  <li class="mb-2">Optimize overall wellbeing</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      {% endif %}

    </div>
  </div>
</div>

<style>
.hover-lift {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.hover-lift:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 30px rgba(0,0,0,0.15) !important;
}
</style>

{% endblock %}